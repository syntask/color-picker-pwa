<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="initial-scale=1,maximum-scale=1.0,minimum-scale=1.0,user-scalable=no,width=device-width,viewport-fit=cover" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
<title>Dynamic status bar color test</title>
<style>
:root {
    --default-color: #aaaaaa;
    --padding-left: max(env(safe-area-inset-left),16px);
    --padding-right: max(env(safe-area-inset-right),16px);
    --padding-top: env(safe-area-inset-top);
    --padding-bottom: env(safe-area-inset-bottom);
}
html{
	padding: 0;
    margin: 0;
}

body {
    height:100vh;
    width: 100vw;
	margin: 0;
    padding: 0px;
    touch-action: none;
}

.color {
    display: flex;
    flex-direction: column;
    justify-content: flex-end;
    color: #fff;
    padding-left: var(--padding-left);
    padding-right: var(--padding-right);
    padding-top: 16px;
    padding-bottom: 16px;
    font-family: monospace;
    font-size: 2em;
    font-weight: bold;
    flex-grow: 1;
    transition: flex-grow 0.5s;
    text-align: left;
}

#content-area{
	display: flex;
    flex-direction: column;
    height: 100dvh;
}

#top-margin{
    height: var(--padding-top);
    background-color: red;
}

#bottom-margin{
    height: var(--padding-bottom);
    background-color: blue;
}

#add-color-button{
    position: fixed;
    bottom: max(16px, env(safe-area-inset-bottom));
    right: max(16px, env(safe-area-inset-right));
    height: 50px;
    background-color: white;
    color: black;
    font-size: 1.5em;
    font-weight: bold;
    border: none;
    cursor: pointer;
    padding: 0 16px;
    border-radius: 999px;
}

</style>
</head>
<body>
<div id="content-area">
<div id="top-margin"></div>
<div class="color">#00b43d</div>
<div id="bottom-margin"></div>
<button id="add-color-button">Add color</button>
</div>

<script>
const root = document.documentElement; 
var colors = document.querySelectorAll('.color');

const firstColor = colors[0];
const topMargin = document.getElementById('top-margin');
//topMargin.style.backgroundColor = firstColor.textContent;

const lastColor = colors[colors.length - 1];
const bottomMargin = document.getElementById('bottom-margin');
//bottomMargin.style.backgroundColor = lastColor.textContent;

const addColorButton = document.getElementById('add-color-button');
addColorButton.addEventListener('click', (event) => {
    const newColor = document.createElement('div');
    newColor.classList.add('color');
    newColor.textContent = '#' + Math.floor(Math.random()*16777215).toString(16);
    document.getElementById('content-area').insertBefore(newColor, addColorButton);
    updateColors();
});

function updateColors() {
    colors = document.querySelectorAll('.color');
    colors.forEach((color) => {
        color.style.setProperty('background-color', color.textContent);
        color.addEventListener('click', (event) => {
            //TBD
        });
    });
}

updateColors();
</script>
</body>
</html>
